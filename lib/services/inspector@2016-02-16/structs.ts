// Autogenerated API structures for: Amazon Inspector

import * as cmnP from "../../encoding/common.ts";

// refs: 1 - tags: named, input
export interface AddAttributesToFindingsRequest {
  findingArns: string[];
  attributes: Attribute[];
}

// refs: 1 - tags: named, input
export interface CreateAssessmentTargetRequest {
  assessmentTargetName: string;
  resourceGroupArn?: string | null;
}

// refs: 1 - tags: named, input
export interface CreateAssessmentTemplateRequest {
  assessmentTargetArn: string;
  assessmentTemplateName: string;
  durationInSeconds: number;
  rulesPackageArns: string[];
  userAttributesForFindings?: Attribute[] | null;
}

// refs: 1 - tags: named, input
export interface CreateExclusionsPreviewRequest {
  assessmentTemplateArn: string;
}

// refs: 1 - tags: named, input
export interface CreateResourceGroupRequest {
  resourceGroupTags: ResourceGroupTag[];
}

// refs: 1 - tags: named, input
export interface DeleteAssessmentRunRequest {
  assessmentRunArn: string;
}

// refs: 1 - tags: named, input
export interface DeleteAssessmentTargetRequest {
  assessmentTargetArn: string;
}

// refs: 1 - tags: named, input
export interface DeleteAssessmentTemplateRequest {
  assessmentTemplateArn: string;
}

// refs: 1 - tags: named, input
export interface DescribeAssessmentRunsRequest {
  assessmentRunArns: string[];
}

// refs: 1 - tags: named, input
export interface DescribeAssessmentTargetsRequest {
  assessmentTargetArns: string[];
}

// refs: 1 - tags: named, input
export interface DescribeAssessmentTemplatesRequest {
  assessmentTemplateArns: string[];
}

// refs: 1 - tags: named, input
export interface DescribeExclusionsRequest {
  exclusionArns: string[];
  locale?: Locale | null;
}

// refs: 1 - tags: named, input
export interface DescribeFindingsRequest {
  findingArns: string[];
  locale?: Locale | null;
}

// refs: 1 - tags: named, input
export interface DescribeResourceGroupsRequest {
  resourceGroupArns: string[];
}

// refs: 1 - tags: named, input
export interface DescribeRulesPackagesRequest {
  rulesPackageArns: string[];
  locale?: Locale | null;
}

// refs: 1 - tags: named, input
export interface GetAssessmentReportRequest {
  assessmentRunArn: string;
  reportFileFormat: ReportFileFormat;
  reportType: ReportType;
}

// refs: 1 - tags: named, input
export interface GetExclusionsPreviewRequest {
  assessmentTemplateArn: string;
  previewToken: string;
  nextToken?: string | null;
  maxResults?: number | null;
  locale?: Locale | null;
}

// refs: 1 - tags: named, input
export interface GetTelemetryMetadataRequest {
  assessmentRunArn: string;
}

// refs: 1 - tags: named, input
export interface ListAssessmentRunAgentsRequest {
  assessmentRunArn: string;
  filter?: AgentFilter | null;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListAssessmentRunsRequest {
  assessmentTemplateArns?: string[] | null;
  filter?: AssessmentRunFilter | null;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListAssessmentTargetsRequest {
  filter?: AssessmentTargetFilter | null;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListAssessmentTemplatesRequest {
  assessmentTargetArns?: string[] | null;
  filter?: AssessmentTemplateFilter | null;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListEventSubscriptionsRequest {
  resourceArn?: string | null;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListExclusionsRequest {
  assessmentRunArn: string;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListFindingsRequest {
  assessmentRunArns?: string[] | null;
  filter?: FindingFilter | null;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListRulesPackagesRequest {
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListTagsForResourceRequest {
  resourceArn: string;
}

// refs: 1 - tags: named, input
export interface PreviewAgentsRequest {
  previewAgentsArn: string;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface RegisterCrossAccountAccessRoleRequest {
  roleArn: string;
}

// refs: 1 - tags: named, input
export interface RemoveAttributesFromFindingsRequest {
  findingArns: string[];
  attributeKeys: string[];
}

// refs: 1 - tags: named, input
export interface SetTagsForResourceRequest {
  resourceArn: string;
  tags?: Tag[] | null;
}

// refs: 1 - tags: named, input
export interface StartAssessmentRunRequest {
  assessmentTemplateArn: string;
  assessmentRunName?: string | null;
}

// refs: 1 - tags: named, input
export interface StopAssessmentRunRequest {
  assessmentRunArn: string;
  stopAction?: StopAction | null;
}

// refs: 1 - tags: named, input
export interface SubscribeToEventRequest {
  resourceArn: string;
  event: InspectorEvent;
  topicArn: string;
}

// refs: 1 - tags: named, input
export interface UnsubscribeFromEventRequest {
  resourceArn: string;
  event: InspectorEvent;
  topicArn: string;
}

// refs: 1 - tags: named, input
export interface UpdateAssessmentTargetRequest {
  assessmentTargetArn: string;
  assessmentTargetName: string;
  resourceGroupArn?: string | null;
}

// refs: 1 - tags: named, output
export interface AddAttributesToFindingsResponse {
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface CreateAssessmentTargetResponse {
  assessmentTargetArn: string;
}

// refs: 1 - tags: named, output
export interface CreateAssessmentTemplateResponse {
  assessmentTemplateArn: string;
}

// refs: 1 - tags: named, output
export interface CreateExclusionsPreviewResponse {
  previewToken: string;
}

// refs: 1 - tags: named, output
export interface CreateResourceGroupResponse {
  resourceGroupArn: string;
}

// refs: 1 - tags: named, output
export interface DescribeAssessmentRunsResponse {
  assessmentRuns: AssessmentRun[];
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface DescribeAssessmentTargetsResponse {
  assessmentTargets: AssessmentTarget[];
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface DescribeAssessmentTemplatesResponse {
  assessmentTemplates: AssessmentTemplate[];
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface DescribeCrossAccountAccessRoleResponse {
  roleArn: string;
  valid: boolean;
  registeredAt: Date | number;
}

// refs: 1 - tags: named, output
export interface DescribeExclusionsResponse {
  exclusions: { [key: string]: Exclusion | null | undefined };
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface DescribeFindingsResponse {
  findings: Finding[];
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface DescribeResourceGroupsResponse {
  resourceGroups: ResourceGroup[];
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface DescribeRulesPackagesResponse {
  rulesPackages: RulesPackage[];
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface GetAssessmentReportResponse {
  status: ReportStatus;
  url?: string | null;
}

// refs: 1 - tags: named, output
export interface GetExclusionsPreviewResponse {
  previewStatus: PreviewStatus;
  exclusionPreviews?: ExclusionPreview[] | null;
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface GetTelemetryMetadataResponse {
  telemetryMetadata: TelemetryMetadata[];
}

// refs: 1 - tags: named, output
export interface ListAssessmentRunAgentsResponse {
  assessmentRunAgents: AssessmentRunAgent[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListAssessmentRunsResponse {
  assessmentRunArns: string[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListAssessmentTargetsResponse {
  assessmentTargetArns: string[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListAssessmentTemplatesResponse {
  assessmentTemplateArns: string[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListEventSubscriptionsResponse {
  subscriptions: Subscription[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListExclusionsResponse {
  exclusionArns: string[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListFindingsResponse {
  findingArns: string[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListRulesPackagesResponse {
  rulesPackageArns: string[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListTagsForResourceResponse {
  tags: Tag[];
}

// refs: 1 - tags: named, output
export interface PreviewAgentsResponse {
  agentPreviews: AgentPreview[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface RemoveAttributesFromFindingsResponse {
  failedItems: { [key: string]: FailedItemDetails | null | undefined };
}

// refs: 1 - tags: named, output
export interface StartAssessmentRunResponse {
  assessmentRunArn: string;
}

// refs: 10 - tags: input, named, interface, output
export interface Attribute {
  key: string;
  value?: string | null;
}

// refs: 2 - tags: input, named, interface, output
export interface ResourceGroupTag {
  key: string;
  value?: string | null;
}

// refs: 4 - tags: input, named, enum
export type Locale =
| "EN_US"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, enum
export type ReportFileFormat =
| "HTML"
| "PDF"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, enum
export type ReportType =
| "FINDING"
| "FULL"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, interface
export interface AgentFilter {
  agentHealths: AgentHealth[];
  agentHealthCodes: AgentHealthCode[];
}

// refs: 3 - tags: input, named, enum, output
export type AgentHealth =
| "HEALTHY"
| "UNHEALTHY"
| "UNKNOWN"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: input, named, enum, output
export type AgentHealthCode =
| "IDLE"
| "RUNNING"
| "SHUTDOWN"
| "UNHEALTHY"
| "THROTTLED"
| "UNKNOWN"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, interface
export interface AssessmentRunFilter {
  namePattern?: string | null;
  states?: AssessmentRunState[] | null;
  durationRange?: DurationRange | null;
  rulesPackageArns?: string[] | null;
  startTimeRange?: TimestampRange | null;
  completionTimeRange?: TimestampRange | null;
  stateChangeTimeRange?: TimestampRange | null;
}

// refs: 3 - tags: input, named, enum, output
export type AssessmentRunState =
| "CREATED"
| "START_DATA_COLLECTION_PENDING"
| "START_DATA_COLLECTION_IN_PROGRESS"
| "COLLECTING_DATA"
| "STOP_DATA_COLLECTION_PENDING"
| "DATA_COLLECTED"
| "START_EVALUATING_RULES_PENDING"
| "EVALUATING_RULES"
| "FAILED"
| "ERROR"
| "COMPLETED"
| "COMPLETED_WITH_ERRORS"
| "CANCELED"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: input, named, interface
export interface DurationRange {
  minSeconds?: number | null;
  maxSeconds?: number | null;
}

// refs: 4 - tags: input, named, interface
export interface TimestampRange {
  beginDate?: Date | number | null;
  endDate?: Date | number | null;
}

// refs: 1 - tags: input, named, interface
export interface AssessmentTargetFilter {
  assessmentTargetNamePattern?: string | null;
}

// refs: 1 - tags: input, named, interface
export interface AssessmentTemplateFilter {
  namePattern?: string | null;
  durationRange?: DurationRange | null;
  rulesPackageArns?: string[] | null;
}

// refs: 1 - tags: input, named, interface
export interface FindingFilter {
  agentIds?: string[] | null;
  autoScalingGroups?: string[] | null;
  ruleNames?: string[] | null;
  severities?: Severity[] | null;
  rulesPackageArns?: string[] | null;
  attributes?: Attribute[] | null;
  userAttributes?: Attribute[] | null;
  creationTimeRange?: TimestampRange | null;
}

// refs: 3 - tags: input, named, enum, output
export type Severity =
| "Low"
| "Medium"
| "High"
| "Informational"
| "Undefined"
| cmnP.UnexpectedEnumValue;

// refs: 3 - tags: input, named, interface, output
export interface Tag {
  key: string;
  value?: string | null;
}

// refs: 1 - tags: input, named, enum
export type StopAction =
| "START_EVALUATION"
| "SKIP_EVALUATION"
| cmnP.UnexpectedEnumValue;

// refs: 4 - tags: input, named, enum, output
export type InspectorEvent =
| "ASSESSMENT_RUN_STARTED"
| "ASSESSMENT_RUN_COMPLETED"
| "ASSESSMENT_RUN_STATE_CHANGED"
| "FINDING_REPORTED"
| "OTHER"
| cmnP.UnexpectedEnumValue;

// refs: 9 - tags: output, named, interface
export interface FailedItemDetails {
  failureCode: FailedItemErrorCode;
  retryable: boolean;
}

// refs: 9 - tags: output, named, enum
export type FailedItemErrorCode =
| "INVALID_ARN"
| "DUPLICATE_ARN"
| "ITEM_DOES_NOT_EXIST"
| "ACCESS_DENIED"
| "LIMIT_EXCEEDED"
| "INTERNAL_ERROR"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface AssessmentRun {
  arn: string;
  name: string;
  assessmentTemplateArn: string;
  state: AssessmentRunState;
  durationInSeconds: number;
  rulesPackageArns: string[];
  userAttributesForFindings: Attribute[];
  createdAt: Date | number;
  startedAt?: Date | number | null;
  completedAt?: Date | number | null;
  stateChangedAt: Date | number;
  dataCollected: boolean;
  stateChanges: AssessmentRunStateChange[];
  notifications: AssessmentRunNotification[];
  findingCounts: { [key in Severity]: number | null | undefined };
}

// refs: 1 - tags: output, named, interface
export interface AssessmentRunStateChange {
  stateChangedAt: Date | number;
  state: AssessmentRunState;
}

// refs: 1 - tags: output, named, interface
export interface AssessmentRunNotification {
  date: Date | number;
  event: InspectorEvent;
  message?: string | null;
  error: boolean;
  snsTopicArn?: string | null;
  snsPublishStatusCode?: AssessmentRunNotificationSnsStatusCode | null;
}

// refs: 1 - tags: output, named, enum
export type AssessmentRunNotificationSnsStatusCode =
| "SUCCESS"
| "TOPIC_DOES_NOT_EXIST"
| "ACCESS_DENIED"
| "INTERNAL_ERROR"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface AssessmentTarget {
  arn: string;
  name: string;
  resourceGroupArn?: string | null;
  createdAt: Date | number;
  updatedAt: Date | number;
}

// refs: 1 - tags: output, named, interface
export interface AssessmentTemplate {
  arn: string;
  name: string;
  assessmentTargetArn: string;
  durationInSeconds: number;
  rulesPackageArns: string[];
  userAttributesForFindings: Attribute[];
  lastAssessmentRunArn?: string | null;
  assessmentRunCount: number;
  createdAt: Date | number;
}

// refs: 1 - tags: output, named, interface
export interface Exclusion {
  arn: string;
  title: string;
  description: string;
  recommendation: string;
  scopes: Scope[];
  attributes?: Attribute[] | null;
}

// refs: 2 - tags: output, named, interface
export interface Scope {
  key?: ScopeType | null;
  value?: string | null;
}

// refs: 2 - tags: output, named, enum
export type ScopeType =
| "INSTANCE_ID"
| "RULES_PACKAGE_ARN"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface Finding {
  arn: string;
  schemaVersion?: number | null;
  service?: string | null;
  serviceAttributes?: InspectorServiceAttributes | null;
  assetType?: AssetType | null;
  assetAttributes?: AssetAttributes | null;
  id?: string | null;
  title?: string | null;
  description?: string | null;
  recommendation?: string | null;
  severity?: Severity | null;
  numericSeverity?: number | null;
  confidence?: number | null;
  indicatorOfCompromise?: boolean | null;
  attributes: Attribute[];
  userAttributes: Attribute[];
  createdAt: Date | number;
  updatedAt: Date | number;
}

// refs: 1 - tags: output, named, interface
export interface InspectorServiceAttributes {
  schemaVersion: number;
  assessmentRunArn?: string | null;
  rulesPackageArn?: string | null;
}

// refs: 1 - tags: output, named, enum
export type AssetType =
| "ec2-instance"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface AssetAttributes {
  schemaVersion: number;
  agentId?: string | null;
  autoScalingGroup?: string | null;
  amiId?: string | null;
  hostname?: string | null;
  ipv4Addresses?: string[] | null;
  tags?: Tag[] | null;
  networkInterfaces?: NetworkInterface[] | null;
}

// refs: 1 - tags: output, named, interface
export interface NetworkInterface {
  networkInterfaceId?: string | null;
  subnetId?: string | null;
  vpcId?: string | null;
  privateDnsName?: string | null;
  privateIpAddress?: string | null;
  privateIpAddresses?: PrivateIp[] | null;
  publicDnsName?: string | null;
  publicIp?: string | null;
  ipv6Addresses?: string[] | null;
  securityGroups?: SecurityGroup[] | null;
}

// refs: 1 - tags: output, named, interface
export interface PrivateIp {
  privateDnsName?: string | null;
  privateIpAddress?: string | null;
}

// refs: 1 - tags: output, named, interface
export interface SecurityGroup {
  groupName?: string | null;
  groupId?: string | null;
}

// refs: 1 - tags: output, named, interface
export interface ResourceGroup {
  arn: string;
  tags: ResourceGroupTag[];
  createdAt: Date | number;
}

// refs: 1 - tags: output, named, interface
export interface RulesPackage {
  arn: string;
  name: string;
  version: string;
  provider: string;
  description?: string | null;
}

// refs: 1 - tags: output, named, enum
export type ReportStatus =
| "WORK_IN_PROGRESS"
| "FAILED"
| "COMPLETED"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, enum
export type PreviewStatus =
| "WORK_IN_PROGRESS"
| "COMPLETED"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface ExclusionPreview {
  title: string;
  description: string;
  recommendation: string;
  scopes: Scope[];
  attributes?: Attribute[] | null;
}

// refs: 2 - tags: output, named, interface
export interface TelemetryMetadata {
  messageType: string;
  count: number;
  dataSize?: number | null;
}

// refs: 1 - tags: output, named, interface
export interface AssessmentRunAgent {
  agentId: string;
  assessmentRunArn: string;
  agentHealth: AgentHealth;
  agentHealthCode: AgentHealthCode;
  agentHealthDetails?: string | null;
  autoScalingGroup?: string | null;
  telemetryMetadata: TelemetryMetadata[];
}

// refs: 1 - tags: output, named, interface
export interface Subscription {
  resourceArn: string;
  topicArn: string;
  eventSubscriptions: EventSubscription[];
}

// refs: 1 - tags: output, named, interface
export interface EventSubscription {
  event: InspectorEvent;
  subscribedAt: Date | number;
}

// refs: 1 - tags: output, named, interface
export interface AgentPreview {
  hostname?: string | null;
  agentId: string;
  autoScalingGroup?: string | null;
  agentHealth?: AgentHealth | null;
  agentVersion?: string | null;
  operatingSystem?: string | null;
  kernelVersion?: string | null;
  ipv4Address?: string | null;
}
