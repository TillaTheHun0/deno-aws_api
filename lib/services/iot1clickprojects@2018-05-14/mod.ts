// Autogenerated API client for: AWS IoT 1-Click Projects Service

import type { ServiceClient, ApiFactory, ApiMetadata } from '../../client/common.ts';
interface RequestConfig {
  abortSignal?: AbortSignal;
}

import * as cmnP from "../../encoding/common.ts";
import * as jsonP from "../../encoding/json.ts";

export default class IoT1ClickProjects {
  #client: ServiceClient;
  constructor(apiFactory: ApiFactory) {
    this.#client = apiFactory.buildServiceClient(IoT1ClickProjects.ApiMetadata);
  }

  static ApiMetadata: ApiMetadata = {
    "apiVersion": "2018-05-14",
    "endpointPrefix": "projects.iot1click",
    "jsonVersion": "1.1",
    "protocol": "rest-json",
    "serviceAbbreviation": "AWS IoT 1-Click Projects",
    "serviceFullName": "AWS IoT 1-Click Projects Service",
    "serviceId": "IoT 1Click Projects",
    "signatureVersion": "v4",
    "signingName": "iot1click",
    "uid": "iot1click-projects-2018-05-14"
  };

  async associateDeviceWithPlacement(
    {abortSignal, ...params}: RequestConfig & AssociateDeviceWithPlacementRequest,
  ): Promise<AssociateDeviceWithPlacementResponse> {
    const body: jsonP.JSONObject = {
      deviceId: params["deviceId"],
    };
    const resp = await this.#client.performRequest({
      abortSignal, body,
      action: "AssociateDeviceWithPlacement",
      method: "PUT",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements/${params["placementName"]}/devices/${params["deviceTemplateName"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async createPlacement(
    {abortSignal, ...params}: RequestConfig & CreatePlacementRequest,
  ): Promise<CreatePlacementResponse> {
    const body: jsonP.JSONObject = {
      placementName: params["placementName"],
      attributes: params["attributes"],
    };
    const resp = await this.#client.performRequest({
      abortSignal, body,
      action: "CreatePlacement",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async createProject(
    {abortSignal, ...params}: RequestConfig & CreateProjectRequest,
  ): Promise<CreateProjectResponse> {
    const body: jsonP.JSONObject = {
      projectName: params["projectName"],
      description: params["description"],
      placementTemplate: fromPlacementTemplate(params["placementTemplate"]),
      tags: params["tags"],
    };
    const resp = await this.#client.performRequest({
      abortSignal, body,
      action: "CreateProject",
      requestUri: "/projects",
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async deletePlacement(
    {abortSignal, ...params}: RequestConfig & DeletePlacementRequest,
  ): Promise<DeletePlacementResponse> {

    const resp = await this.#client.performRequest({
      abortSignal,
      action: "DeletePlacement",
      method: "DELETE",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements/${params["placementName"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async deleteProject(
    {abortSignal, ...params}: RequestConfig & DeleteProjectRequest,
  ): Promise<DeleteProjectResponse> {

    const resp = await this.#client.performRequest({
      abortSignal,
      action: "DeleteProject",
      method: "DELETE",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async describePlacement(
    {abortSignal, ...params}: RequestConfig & DescribePlacementRequest,
  ): Promise<DescribePlacementResponse> {

    const resp = await this.#client.performRequest({
      abortSignal,
      action: "DescribePlacement",
      method: "GET",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements/${params["placementName"]}`,
    });
    return jsonP.readObj({
      required: {
        "placement": toPlacementDescription,
      },
      optional: {},
    }, await resp.json());
  }

  async describeProject(
    {abortSignal, ...params}: RequestConfig & DescribeProjectRequest,
  ): Promise<DescribeProjectResponse> {

    const resp = await this.#client.performRequest({
      abortSignal,
      action: "DescribeProject",
      method: "GET",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}`,
    });
    return jsonP.readObj({
      required: {
        "project": toProjectDescription,
      },
      optional: {},
    }, await resp.json());
  }

  async disassociateDeviceFromPlacement(
    {abortSignal, ...params}: RequestConfig & DisassociateDeviceFromPlacementRequest,
  ): Promise<DisassociateDeviceFromPlacementResponse> {

    const resp = await this.#client.performRequest({
      abortSignal,
      action: "DisassociateDeviceFromPlacement",
      method: "DELETE",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements/${params["placementName"]}/devices/${params["deviceTemplateName"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async getDevicesInPlacement(
    {abortSignal, ...params}: RequestConfig & GetDevicesInPlacementRequest,
  ): Promise<GetDevicesInPlacementResponse> {

    const resp = await this.#client.performRequest({
      abortSignal,
      action: "GetDevicesInPlacement",
      method: "GET",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements/${params["placementName"]}/devices`,
    });
    return jsonP.readObj({
      required: {
        "devices": x => jsonP.readMap(String, String, x),
      },
      optional: {},
    }, await resp.json());
  }

  async listPlacements(
    {abortSignal, ...params}: RequestConfig & ListPlacementsRequest,
  ): Promise<ListPlacementsResponse> {
    const query = new URLSearchParams;
    if (params["nextToken"] != null) query.set("nextToken", params["nextToken"]?.toString() ?? "");
    if (params["maxResults"] != null) query.set("maxResults", params["maxResults"]?.toString() ?? "");
    const resp = await this.#client.performRequest({
      abortSignal, query,
      action: "ListPlacements",
      method: "GET",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements`,
    });
    return jsonP.readObj({
      required: {
        "placements": [toPlacementSummary],
      },
      optional: {
        "nextToken": "s",
      },
    }, await resp.json());
  }

  async listProjects(
    {abortSignal, ...params}: RequestConfig & ListProjectsRequest = {},
  ): Promise<ListProjectsResponse> {
    const query = new URLSearchParams;
    if (params["nextToken"] != null) query.set("nextToken", params["nextToken"]?.toString() ?? "");
    if (params["maxResults"] != null) query.set("maxResults", params["maxResults"]?.toString() ?? "");
    const resp = await this.#client.performRequest({
      abortSignal, query,
      action: "ListProjects",
      method: "GET",
      requestUri: "/projects",
    });
    return jsonP.readObj({
      required: {
        "projects": [toProjectSummary],
      },
      optional: {
        "nextToken": "s",
      },
    }, await resp.json());
  }

  async listTagsForResource(
    {abortSignal, ...params}: RequestConfig & ListTagsForResourceRequest,
  ): Promise<ListTagsForResourceResponse> {

    const resp = await this.#client.performRequest({
      abortSignal,
      action: "ListTagsForResource",
      method: "GET",
      requestUri: cmnP.encodePath`/tags/${params["resourceArn"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {
        "tags": x => jsonP.readMap(String, String, x),
      },
    }, await resp.json());
  }

  async tagResource(
    {abortSignal, ...params}: RequestConfig & TagResourceRequest,
  ): Promise<TagResourceResponse> {
    const body: jsonP.JSONObject = {
      tags: params["tags"],
    };
    const resp = await this.#client.performRequest({
      abortSignal, body,
      action: "TagResource",
      requestUri: cmnP.encodePath`/tags/${params["resourceArn"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async untagResource(
    {abortSignal, ...params}: RequestConfig & UntagResourceRequest,
  ): Promise<UntagResourceResponse> {
    const query = new URLSearchParams;
    for (const item of params["tagKeys"]) {
      query.append("tagKeys", item?.toString() ?? "");
    }
    const resp = await this.#client.performRequest({
      abortSignal, query,
      action: "UntagResource",
      method: "DELETE",
      requestUri: cmnP.encodePath`/tags/${params["resourceArn"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async updatePlacement(
    {abortSignal, ...params}: RequestConfig & UpdatePlacementRequest,
  ): Promise<UpdatePlacementResponse> {
    const body: jsonP.JSONObject = {
      attributes: params["attributes"],
    };
    const resp = await this.#client.performRequest({
      abortSignal, body,
      action: "UpdatePlacement",
      method: "PUT",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}/placements/${params["placementName"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

  async updateProject(
    {abortSignal, ...params}: RequestConfig & UpdateProjectRequest,
  ): Promise<UpdateProjectResponse> {
    const body: jsonP.JSONObject = {
      description: params["description"],
      placementTemplate: fromPlacementTemplate(params["placementTemplate"]),
    };
    const resp = await this.#client.performRequest({
      abortSignal, body,
      action: "UpdateProject",
      method: "PUT",
      requestUri: cmnP.encodePath`/projects/${params["projectName"]}`,
    });
    return jsonP.readObj({
      required: {},
      optional: {},
    }, await resp.json());
  }

}

// refs: 1 - tags: named, input
export interface AssociateDeviceWithPlacementRequest {
  projectName: string;
  placementName: string;
  deviceId: string;
  deviceTemplateName: string;
}

// refs: 1 - tags: named, input
export interface CreatePlacementRequest {
  placementName: string;
  projectName: string;
  attributes?: { [key: string]: string | null | undefined } | null;
}

// refs: 1 - tags: named, input
export interface CreateProjectRequest {
  projectName: string;
  description?: string | null;
  placementTemplate?: PlacementTemplate | null;
  tags?: { [key: string]: string | null | undefined } | null;
}

// refs: 1 - tags: named, input
export interface DeletePlacementRequest {
  placementName: string;
  projectName: string;
}

// refs: 1 - tags: named, input
export interface DeleteProjectRequest {
  projectName: string;
}

// refs: 1 - tags: named, input
export interface DescribePlacementRequest {
  placementName: string;
  projectName: string;
}

// refs: 1 - tags: named, input
export interface DescribeProjectRequest {
  projectName: string;
}

// refs: 1 - tags: named, input
export interface DisassociateDeviceFromPlacementRequest {
  projectName: string;
  placementName: string;
  deviceTemplateName: string;
}

// refs: 1 - tags: named, input
export interface GetDevicesInPlacementRequest {
  projectName: string;
  placementName: string;
}

// refs: 1 - tags: named, input
export interface ListPlacementsRequest {
  projectName: string;
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListProjectsRequest {
  nextToken?: string | null;
  maxResults?: number | null;
}

// refs: 1 - tags: named, input
export interface ListTagsForResourceRequest {
  resourceArn: string;
}

// refs: 1 - tags: named, input
export interface TagResourceRequest {
  resourceArn: string;
  tags: { [key: string]: string | null | undefined };
}

// refs: 1 - tags: named, input
export interface UntagResourceRequest {
  resourceArn: string;
  tagKeys: string[];
}

// refs: 1 - tags: named, input
export interface UpdatePlacementRequest {
  placementName: string;
  projectName: string;
  attributes?: { [key: string]: string | null | undefined } | null;
}

// refs: 1 - tags: named, input
export interface UpdateProjectRequest {
  projectName: string;
  description?: string | null;
  placementTemplate?: PlacementTemplate | null;
}

// refs: 1 - tags: named, output
export interface AssociateDeviceWithPlacementResponse {
}

// refs: 1 - tags: named, output
export interface CreatePlacementResponse {
}

// refs: 1 - tags: named, output
export interface CreateProjectResponse {
}

// refs: 1 - tags: named, output
export interface DeletePlacementResponse {
}

// refs: 1 - tags: named, output
export interface DeleteProjectResponse {
}

// refs: 1 - tags: named, output
export interface DescribePlacementResponse {
  placement: PlacementDescription;
}

// refs: 1 - tags: named, output
export interface DescribeProjectResponse {
  project: ProjectDescription;
}

// refs: 1 - tags: named, output
export interface DisassociateDeviceFromPlacementResponse {
}

// refs: 1 - tags: named, output
export interface GetDevicesInPlacementResponse {
  devices: { [key: string]: string | null | undefined };
}

// refs: 1 - tags: named, output
export interface ListPlacementsResponse {
  placements: PlacementSummary[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListProjectsResponse {
  projects: ProjectSummary[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListTagsForResourceResponse {
  tags?: { [key: string]: string | null | undefined } | null;
}

// refs: 1 - tags: named, output
export interface TagResourceResponse {
}

// refs: 1 - tags: named, output
export interface UntagResourceResponse {
}

// refs: 1 - tags: named, output
export interface UpdatePlacementResponse {
}

// refs: 1 - tags: named, output
export interface UpdateProjectResponse {
}

// refs: 3 - tags: input, named, interface, output
export interface PlacementTemplate {
  defaultAttributes?: { [key: string]: string | null | undefined } | null;
  deviceTemplates?: { [key: string]: DeviceTemplate | null | undefined } | null;
}
function fromPlacementTemplate(input?: PlacementTemplate | null): jsonP.JSONValue {
  if (!input) return input;
  return {
    defaultAttributes: input["defaultAttributes"],
    deviceTemplates: jsonP.serializeMap(input["deviceTemplates"], x => fromDeviceTemplate(x)),
  }
}
function toPlacementTemplate(root: jsonP.JSONValue): PlacementTemplate {
  return jsonP.readObj({
    required: {},
    optional: {
      "defaultAttributes": x => jsonP.readMap(String, String, x),
      "deviceTemplates": x => jsonP.readMap(String, toDeviceTemplate, x),
    },
  }, root);
}

// refs: 3 - tags: input, named, interface, output
export interface DeviceTemplate {
  deviceType?: string | null;
  callbackOverrides?: { [key: string]: string | null | undefined } | null;
}
function fromDeviceTemplate(input?: DeviceTemplate | null): jsonP.JSONValue {
  if (!input) return input;
  return {
    deviceType: input["deviceType"],
    callbackOverrides: input["callbackOverrides"],
  }
}
function toDeviceTemplate(root: jsonP.JSONValue): DeviceTemplate {
  return jsonP.readObj({
    required: {},
    optional: {
      "deviceType": "s",
      "callbackOverrides": x => jsonP.readMap(String, String, x),
    },
  }, root);
}

// refs: 1 - tags: output, named, interface
export interface PlacementDescription {
  projectName: string;
  placementName: string;
  attributes: { [key: string]: string | null | undefined };
  createdDate: Date | number;
  updatedDate: Date | number;
}
function toPlacementDescription(root: jsonP.JSONValue): PlacementDescription {
  return jsonP.readObj({
    required: {
      "projectName": "s",
      "placementName": "s",
      "attributes": x => jsonP.readMap(String, String, x),
      "createdDate": "d",
      "updatedDate": "d",
    },
    optional: {},
  }, root);
}

// refs: 1 - tags: output, named, interface
export interface ProjectDescription {
  arn?: string | null;
  projectName: string;
  description?: string | null;
  createdDate: Date | number;
  updatedDate: Date | number;
  placementTemplate?: PlacementTemplate | null;
  tags?: { [key: string]: string | null | undefined } | null;
}
function toProjectDescription(root: jsonP.JSONValue): ProjectDescription {
  return jsonP.readObj({
    required: {
      "projectName": "s",
      "createdDate": "d",
      "updatedDate": "d",
    },
    optional: {
      "arn": "s",
      "description": "s",
      "placementTemplate": toPlacementTemplate,
      "tags": x => jsonP.readMap(String, String, x),
    },
  }, root);
}

// refs: 1 - tags: output, named, interface
export interface PlacementSummary {
  projectName: string;
  placementName: string;
  createdDate: Date | number;
  updatedDate: Date | number;
}
function toPlacementSummary(root: jsonP.JSONValue): PlacementSummary {
  return jsonP.readObj({
    required: {
      "projectName": "s",
      "placementName": "s",
      "createdDate": "d",
      "updatedDate": "d",
    },
    optional: {},
  }, root);
}

// refs: 1 - tags: output, named, interface
export interface ProjectSummary {
  arn?: string | null;
  projectName: string;
  createdDate: Date | number;
  updatedDate: Date | number;
  tags?: { [key: string]: string | null | undefined } | null;
}
function toProjectSummary(root: jsonP.JSONValue): ProjectSummary {
  return jsonP.readObj({
    required: {
      "projectName": "s",
      "createdDate": "d",
      "updatedDate": "d",
    },
    optional: {
      "arn": "s",
      "tags": x => jsonP.readMap(String, String, x),
    },
  }, root);
}
