// Autogenerated API structures for: Access Analyzer

import * as cmnP from "../../encoding/common.ts";

// refs: 1 - tags: named, input
export interface ApplyArchiveRuleRequest {
  analyzerArn: string;
  clientToken?: string | null;
  ruleName: string;
}

// refs: 1 - tags: named, input
export interface CreateAccessPreviewRequest {
  analyzerArn: string;
  clientToken?: string | null;
  configurations: { [key: string]: Configuration | null | undefined };
}

// refs: 1 - tags: named, input
export interface CreateAnalyzerRequest {
  analyzerName: string;
  archiveRules?: InlineArchiveRule[] | null;
  clientToken?: string | null;
  tags?: { [key: string]: string | null | undefined } | null;
  type: Type;
}

// refs: 1 - tags: named, input
export interface CreateArchiveRuleRequest {
  analyzerName: string;
  clientToken?: string | null;
  filter: { [key: string]: Criterion | null | undefined };
  ruleName: string;
}

// refs: 1 - tags: named, input
export interface DeleteAnalyzerRequest {
  analyzerName: string;
  clientToken?: string | null;
}

// refs: 1 - tags: named, input
export interface DeleteArchiveRuleRequest {
  analyzerName: string;
  clientToken?: string | null;
  ruleName: string;
}

// refs: 1 - tags: named, input
export interface GetAccessPreviewRequest {
  accessPreviewId: string;
  analyzerArn: string;
}

// refs: 1 - tags: named, input
export interface GetAnalyzedResourceRequest {
  analyzerArn: string;
  resourceArn: string;
}

// refs: 1 - tags: named, input
export interface GetAnalyzerRequest {
  analyzerName: string;
}

// refs: 1 - tags: named, input
export interface GetArchiveRuleRequest {
  analyzerName: string;
  ruleName: string;
}

// refs: 1 - tags: named, input
export interface GetFindingRequest {
  analyzerArn: string;
  id: string;
}

// refs: 1 - tags: named, input
export interface ListAccessPreviewFindingsRequest {
  accessPreviewId: string;
  analyzerArn: string;
  filter?: { [key: string]: Criterion | null | undefined } | null;
  maxResults?: number | null;
  nextToken?: string | null;
}

// refs: 1 - tags: named, input
export interface ListAccessPreviewsRequest {
  analyzerArn: string;
  maxResults?: number | null;
  nextToken?: string | null;
}

// refs: 1 - tags: named, input
export interface ListAnalyzedResourcesRequest {
  analyzerArn: string;
  maxResults?: number | null;
  nextToken?: string | null;
  resourceType?: ResourceType | null;
}

// refs: 1 - tags: named, input
export interface ListAnalyzersRequest {
  maxResults?: number | null;
  nextToken?: string | null;
  type?: Type | null;
}

// refs: 1 - tags: named, input
export interface ListArchiveRulesRequest {
  analyzerName: string;
  maxResults?: number | null;
  nextToken?: string | null;
}

// refs: 1 - tags: named, input
export interface ListFindingsRequest {
  analyzerArn: string;
  filter?: { [key: string]: Criterion | null | undefined } | null;
  maxResults?: number | null;
  nextToken?: string | null;
  sort?: SortCriteria | null;
}

// refs: 1 - tags: named, input
export interface ListTagsForResourceRequest {
  resourceArn: string;
}

// refs: 1 - tags: named, input
export interface StartResourceScanRequest {
  analyzerArn: string;
  resourceArn: string;
}

// refs: 1 - tags: named, input
export interface TagResourceRequest {
  resourceArn: string;
  tags: { [key: string]: string | null | undefined };
}

// refs: 1 - tags: named, input
export interface UntagResourceRequest {
  resourceArn: string;
  tagKeys: string[];
}

// refs: 1 - tags: named, input
export interface UpdateArchiveRuleRequest {
  analyzerName: string;
  clientToken?: string | null;
  filter: { [key: string]: Criterion | null | undefined };
  ruleName: string;
}

// refs: 1 - tags: named, input
export interface UpdateFindingsRequest {
  analyzerArn: string;
  clientToken?: string | null;
  ids?: string[] | null;
  resourceArn?: string | null;
  status: FindingStatusUpdate;
}

// refs: 1 - tags: named, input
export interface ValidatePolicyRequest {
  locale?: Locale | null;
  maxResults?: number | null;
  nextToken?: string | null;
  policyDocument: string;
  policyType: PolicyType;
}

// refs: 1 - tags: named, output
export interface CreateAccessPreviewResponse {
  id: string;
}

// refs: 1 - tags: named, output
export interface CreateAnalyzerResponse {
  arn?: string | null;
}

// refs: 1 - tags: named, output
export interface GetAccessPreviewResponse {
  accessPreview: AccessPreview;
}

// refs: 1 - tags: named, output
export interface GetAnalyzedResourceResponse {
  resource?: AnalyzedResource | null;
}

// refs: 1 - tags: named, output
export interface GetAnalyzerResponse {
  analyzer: AnalyzerSummary;
}

// refs: 1 - tags: named, output
export interface GetArchiveRuleResponse {
  archiveRule: ArchiveRuleSummary;
}

// refs: 1 - tags: named, output
export interface GetFindingResponse {
  finding?: Finding | null;
}

// refs: 1 - tags: named, output
export interface ListAccessPreviewFindingsResponse {
  findings: AccessPreviewFinding[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListAccessPreviewsResponse {
  accessPreviews: AccessPreviewSummary[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListAnalyzedResourcesResponse {
  analyzedResources: AnalyzedResourceSummary[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListAnalyzersResponse {
  analyzers: AnalyzerSummary[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListArchiveRulesResponse {
  archiveRules: ArchiveRuleSummary[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListFindingsResponse {
  findings: FindingSummary[];
  nextToken?: string | null;
}

// refs: 1 - tags: named, output
export interface ListTagsForResourceResponse {
  tags?: { [key: string]: string | null | undefined } | null;
}

// refs: 1 - tags: named, output
export interface TagResourceResponse {
}

// refs: 1 - tags: named, output
export interface UntagResourceResponse {
}

// refs: 1 - tags: named, output
export interface ValidatePolicyResponse {
  findings: ValidatePolicyFinding[];
  nextToken?: string | null;
}

// refs: 2 - tags: input, named, interface, output
export interface Configuration {
  iamRole?: IamRoleConfiguration | null;
  kmsKey?: KmsKeyConfiguration | null;
  s3Bucket?: S3BucketConfiguration | null;
  secretsManagerSecret?: SecretsManagerSecretConfiguration | null;
  sqsQueue?: SqsQueueConfiguration | null;
}

// refs: 2 - tags: input, named, interface, output
export interface IamRoleConfiguration {
  trustPolicy?: string | null;
}

// refs: 2 - tags: input, named, interface, output
export interface KmsKeyConfiguration {
  grants?: KmsGrantConfiguration[] | null;
  keyPolicies?: { [key: string]: string | null | undefined } | null;
}

// refs: 2 - tags: input, named, interface, output
export interface KmsGrantConfiguration {
  constraints?: KmsGrantConstraints | null;
  granteePrincipal: string;
  issuingAccount: string;
  operations: KmsGrantOperation[];
  retiringPrincipal?: string | null;
}

// refs: 2 - tags: input, named, interface, output
export interface KmsGrantConstraints {
  encryptionContextEquals?: { [key: string]: string | null | undefined } | null;
  encryptionContextSubset?: { [key: string]: string | null | undefined } | null;
}

// refs: 2 - tags: input, named, enum, output
export type KmsGrantOperation =
| "CreateGrant"
| "Decrypt"
| "DescribeKey"
| "Encrypt"
| "GenerateDataKey"
| "GenerateDataKeyPair"
| "GenerateDataKeyPairWithoutPlaintext"
| "GenerateDataKeyWithoutPlaintext"
| "GetPublicKey"
| "ReEncryptFrom"
| "ReEncryptTo"
| "RetireGrant"
| "Sign"
| "Verify"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: input, named, interface, output
export interface S3BucketConfiguration {
  accessPoints?: { [key: string]: S3AccessPointConfiguration | null | undefined } | null;
  bucketAclGrants?: S3BucketAclGrantConfiguration[] | null;
  bucketPolicy?: string | null;
  bucketPublicAccessBlock?: S3PublicAccessBlockConfiguration | null;
}

// refs: 2 - tags: input, named, interface, output
export interface S3AccessPointConfiguration {
  accessPointPolicy?: string | null;
  networkOrigin?: NetworkOriginConfiguration | null;
  publicAccessBlock?: S3PublicAccessBlockConfiguration | null;
}

// refs: 2 - tags: input, named, interface, output
export interface NetworkOriginConfiguration {
  internetConfiguration?: InternetConfiguration | null;
  vpcConfiguration?: VpcConfiguration | null;
}

// refs: 2 - tags: input, named, interface, output
export interface InternetConfiguration {
}

// refs: 2 - tags: input, named, interface, output
export interface VpcConfiguration {
  vpcId: string;
}

// refs: 4 - tags: input, named, interface, output
export interface S3PublicAccessBlockConfiguration {
  ignorePublicAcls: boolean;
  restrictPublicBuckets: boolean;
}

// refs: 2 - tags: input, named, interface, output
export interface S3BucketAclGrantConfiguration {
  grantee: AclGrantee;
  permission: AclPermission;
}

// refs: 2 - tags: input, named, interface, output
export interface AclGrantee {
  id?: string | null;
  uri?: string | null;
}

// refs: 2 - tags: input, named, enum, output
export type AclPermission =
| "READ"
| "WRITE"
| "READ_ACP"
| "WRITE_ACP"
| "FULL_CONTROL"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: input, named, interface, output
export interface SecretsManagerSecretConfiguration {
  kmsKeyId?: string | null;
  secretPolicy?: string | null;
}

// refs: 2 - tags: input, named, interface, output
export interface SqsQueueConfiguration {
  queuePolicy?: string | null;
}

// refs: 1 - tags: input, named, interface
export interface InlineArchiveRule {
  filter: { [key: string]: Criterion | null | undefined };
  ruleName: string;
}

// refs: 7 - tags: input, named, interface, output
export interface Criterion {
  contains?: string[] | null;
  eq?: string[] | null;
  exists?: boolean | null;
  neq?: string[] | null;
}

// refs: 4 - tags: input, named, enum, output
export type Type =
| "ACCOUNT"
| "ORGANIZATION"
| cmnP.UnexpectedEnumValue;

// refs: 6 - tags: input, named, enum, output
export type ResourceType =
| "AWS::S3::Bucket"
| "AWS::IAM::Role"
| "AWS::SQS::Queue"
| "AWS::Lambda::Function"
| "AWS::Lambda::LayerVersion"
| "AWS::KMS::Key"
| "AWS::SecretsManager::Secret"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, interface
export interface SortCriteria {
  attributeName?: string | null;
  orderBy?: OrderBy | null;
}

// refs: 1 - tags: input, named, enum
export type OrderBy =
| "ASC"
| "DESC"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, enum
export type FindingStatusUpdate =
| "ACTIVE"
| "ARCHIVED"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, enum
export type Locale =
| "DE"
| "EN"
| "ES"
| "FR"
| "IT"
| "JA"
| "KO"
| "PT_BR"
| "ZH_CN"
| "ZH_TW"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: input, named, enum
export type PolicyType =
| "IDENTITY_POLICY"
| "RESOURCE_POLICY"
| "SERVICE_CONTROL_POLICY"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface AccessPreview {
  analyzerArn: string;
  configurations: { [key: string]: Configuration | null | undefined };
  createdAt: Date | number;
  id: string;
  status: AccessPreviewStatus;
  statusReason?: AccessPreviewStatusReason | null;
}

// refs: 2 - tags: output, named, enum
export type AccessPreviewStatus =
| "COMPLETED"
| "CREATING"
| "FAILED"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: output, named, interface
export interface AccessPreviewStatusReason {
  code: AccessPreviewStatusReasonCode;
}

// refs: 2 - tags: output, named, enum
export type AccessPreviewStatusReasonCode =
| "INTERNAL_ERROR"
| "INVALID_CONFIGURATION"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface AnalyzedResource {
  actions?: string[] | null;
  analyzedAt: Date | number;
  createdAt: Date | number;
  error?: string | null;
  isPublic: boolean;
  resourceArn: string;
  resourceOwnerAccount: string;
  resourceType: ResourceType;
  sharedVia?: string[] | null;
  status?: FindingStatus | null;
  updatedAt: Date | number;
}

// refs: 5 - tags: output, named, enum
export type FindingStatus =
| "ACTIVE"
| "ARCHIVED"
| "RESOLVED"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: output, named, interface
export interface AnalyzerSummary {
  arn: string;
  createdAt: Date | number;
  lastResourceAnalyzed?: string | null;
  lastResourceAnalyzedAt?: Date | number | null;
  name: string;
  status: AnalyzerStatus;
  statusReason?: StatusReason | null;
  tags?: { [key: string]: string | null | undefined } | null;
  type: Type;
}

// refs: 2 - tags: output, named, enum
export type AnalyzerStatus =
| "ACTIVE"
| "CREATING"
| "DISABLED"
| "FAILED"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: output, named, interface
export interface StatusReason {
  code: ReasonCode;
}

// refs: 2 - tags: output, named, enum
export type ReasonCode =
| "AWS_SERVICE_ACCESS_DISABLED"
| "DELEGATED_ADMINISTRATOR_DEREGISTERED"
| "ORGANIZATION_DELETED"
| "SERVICE_LINKED_ROLE_CREATION_FAILED"
| cmnP.UnexpectedEnumValue;

// refs: 2 - tags: output, named, interface
export interface ArchiveRuleSummary {
  createdAt: Date | number;
  filter: { [key: string]: Criterion | null | undefined };
  ruleName: string;
  updatedAt: Date | number;
}

// refs: 1 - tags: output, named, interface
export interface Finding {
  action?: string[] | null;
  analyzedAt: Date | number;
  condition: { [key: string]: string | null | undefined };
  createdAt: Date | number;
  error?: string | null;
  id: string;
  isPublic?: boolean | null;
  principal?: { [key: string]: string | null | undefined } | null;
  resource?: string | null;
  resourceOwnerAccount: string;
  resourceType: ResourceType;
  sources?: FindingSource[] | null;
  status: FindingStatus;
  updatedAt: Date | number;
}

// refs: 3 - tags: output, named, interface
export interface FindingSource {
  detail?: FindingSourceDetail | null;
  type: FindingSourceType;
}

// refs: 3 - tags: output, named, interface
export interface FindingSourceDetail {
  accessPointArn?: string | null;
}

// refs: 3 - tags: output, named, enum
export type FindingSourceType =
| "POLICY"
| "BUCKET_ACL"
| "S3_ACCESS_POINT"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface AccessPreviewFinding {
  action?: string[] | null;
  changeType: FindingChangeType;
  condition?: { [key: string]: string | null | undefined } | null;
  createdAt: Date | number;
  error?: string | null;
  existingFindingId?: string | null;
  existingFindingStatus?: FindingStatus | null;
  id: string;
  isPublic?: boolean | null;
  principal?: { [key: string]: string | null | undefined } | null;
  resource?: string | null;
  resourceOwnerAccount: string;
  resourceType: ResourceType;
  sources?: FindingSource[] | null;
  status: FindingStatus;
}

// refs: 1 - tags: output, named, enum
export type FindingChangeType =
| "CHANGED"
| "NEW"
| "UNCHANGED"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface AccessPreviewSummary {
  analyzerArn: string;
  createdAt: Date | number;
  id: string;
  status: AccessPreviewStatus;
  statusReason?: AccessPreviewStatusReason | null;
}

// refs: 1 - tags: output, named, interface
export interface AnalyzedResourceSummary {
  resourceArn: string;
  resourceOwnerAccount: string;
  resourceType: ResourceType;
}

// refs: 1 - tags: output, named, interface
export interface FindingSummary {
  action?: string[] | null;
  analyzedAt: Date | number;
  condition: { [key: string]: string | null | undefined };
  createdAt: Date | number;
  error?: string | null;
  id: string;
  isPublic?: boolean | null;
  principal?: { [key: string]: string | null | undefined } | null;
  resource?: string | null;
  resourceOwnerAccount: string;
  resourceType: ResourceType;
  sources?: FindingSource[] | null;
  status: FindingStatus;
  updatedAt: Date | number;
}

// refs: 1 - tags: output, named, interface
export interface ValidatePolicyFinding {
  findingDetails: string;
  findingType: ValidatePolicyFindingType;
  issueCode: string;
  learnMoreLink: string;
  locations: Location[];
}

// refs: 1 - tags: output, named, enum
export type ValidatePolicyFindingType =
| "ERROR"
| "SECURITY_WARNING"
| "SUGGESTION"
| "WARNING"
| cmnP.UnexpectedEnumValue;

// refs: 1 - tags: output, named, interface
export interface Location {
  path: PathElement[];
  span: Span;
}

// refs: 1 - tags: output, named, interface
export interface PathElement {
  index?: number | null;
  key?: string | null;
  substring?: Substring | null;
  value?: string | null;
}

// refs: 1 - tags: output, named, interface
export interface Substring {
  length: number;
  start: number;
}

// refs: 1 - tags: output, named, interface
export interface Span {
  end: Position;
  start: Position;
}

// refs: 2 - tags: output, named, interface
export interface Position {
  column: number;
  line: number;
  offset: number;
}
